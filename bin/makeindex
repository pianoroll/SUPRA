#!/usr/bin/perl

use strict;

my $rolltext = `which rolltext`;
chomp $rolltext;
die "Cannot find program $rolltext" if $rolltext =~ /^\s*$/;

my @list = sort glob "*/midi-exp/*_exp.mid";


my $druid;
foreach my $item (@list) {
	print "\@\@BEGIN: ROLL\n";
	my $data = `rolltext $item`;
	if ($data !~ /\@DRUID/) {
		$druid = $item;
		$druid =~ s/.*\///;
		$druid =~ s/_.*//;
		print STDERR "ITEM $item does not have a druid\n";
		print STDERR"\tADDING IT AUTOMATICALLY: $druid\n";
	}
	print $data;
	if ($druid !~ /^\s*$/) {
		print "\@DRUID:\t\t$druid\n";
	}
	$druid = "";
	print "\@\@END: ROLL\n\n\n";
}


